# Changelog

## [Unreleased]

### Added
- **Ambient Wind Sound System**:
  - Procedural wind ambient sound using Tone.js
  - Realistic wind generation with PinkNoise, low-pass filter, and LFO modulation
  - Natural wind gusts via frequency modulation (0.2 Hz cycle)
  - Automatic start/stop when entering/exiting first-person mode
  - Integration with master audio settings (respects toggle and volume)
  - Smooth volume transitions and proper audio context management
  - Base volume set to 35% for subtle, non-intrusive ambience
  - Console warning suppression for expected browser audio security messages
- **World Loading Screen**: 
  - Full-screen loading overlay with animated progress bar (z-index: 9999)
  - Fully opaque background that completely blocks menu and game world view
  - Automatically hides ALL UI elements when shown (title, menu, buttons, news reel, panels)
  - Real-time percentage display (0-100%)
  - Dynamic status text updates during generation stages:
    - "Initializing world generation..." (0%)
    - "Generating terrain..." (0-30%)
    - "Building structures..." (30-60%)
    - "Placing trees and decorations..." (60-90%)
    - "Finalizing world..." (90-100%)
    - "Entering world..." (100%)
  - Animated spinner with multiple rotating rings
  - Shimmer effect on progress bar fill
  - Smooth fade-in/fade-out transitions
  - Progress tracking integrated with world generation via callback system
  - Error handling with UI restoration if generation fails
- **Settings Panel Enhancements**:
  - Tabbed interface with Audio, Controls, and Video tabs
  - Modern tab navigation with active state indicators
  - Smooth tab switching with fade animations
- **Audio Settings with Volume Sliders**:
  - Draggable volume sliders for Master Audio and Background Music
  - Real-time percentage display (0-100%)
  - Instant responsive dragging (no lag)
  - Toggle switches for enable/disable
  - Volume calculation: Master × Music = final volume
  - localStorage persistence for volume settings
  - Visual feedback with glow effects and smooth animations
  - Disabled state styling when toggles are off
- **First-Person Camera Mode**: 
  - Full first-person view with mouse look controls (PointerLockControls)
  - Camera spawns at ground level with proper eye height (1.6 units)
  - Smooth transition from orbit camera to first-person mode
  - Pitch limits prevent camera flipping
  - Pointer lock for immersive mouse look experience
  - Main menu background music automatically stops when entering game mode
- **Dual World System**:
  - **Menu World**: Separate world for menu/preview viewing (75 block radius)
  - **Game World**: Separate larger world for gameplay (150 block radius, 2x size)
  - Menu world remains intact when generating game world
  - Game world generated in dedicated THREE.Group container
  - Both worlds can coexist without interference
- **World Generation System**:
  - Interactive world generation panel with toggle switches
  - Conditional world generation based on user preferences:
    - Trees toggle (enable/disable tree generation)
    - Christmas Lights toggle (enable/disable lights on trees)
    - House toggle (enable/disable house structure)
    - Hills toggle (enable/disable terrain elevation)
  - Async world generation with Promise-based flow
  - Progress feedback via button text updates
  - Smooth transitions using requestAnimationFrame
  - Ground height calculation for proper camera positioning (supports both world sizes)
- **Game UI Button Hiding**: 
  - All game UI buttons (tech, quit, fullscreen, show UI) automatically hide when entering first-person mode
  - Complete UI removal for immersive gameplay experience
  - Buttons fade out and are removed from layout
- **WebView2 Windows Packaging**: Lightweight Windows executable packaging using .NET and WebView2
  - Portable distribution package (~1-5MB)
  - Fullscreen application wrapper
  - Packaging scripts in `portable/` folder
  - No installation required - just extract and run
  - **Quit Button**: In-game quit button that closes the application via WebView2 message communication
- **Tech Info Panel**: Toggleable technology display in top right showing WebGPU/WebGL, Three.js, Post-Processing, Instanced Rendering, Particle Systems, and OrbitControls.
- **World Generation Panel**: Interactive panel accessible via Play button showing world generation stats and progress.
- **RGB LED News Reel**: Pill-shaped news reel with animated RGB LED border that continuously flows around the edges.
  - **Outer RGB Glow**: Animated gradient border (6s cycle) with full color spectrum flowing around pill shape
  - **Border Christmas Lights**: Animated bar lights in black border area (20s cycle) with twinkling effect
  - **Inner Christmas Lights**: Radial gradient lights along inner content edge (16s cycle) with twinkling
  - **Dynamic Snowflakes**: JavaScript-generated snowflakes that spawn at random positions and fall naturally
    - Random horizontal spawn positions
    - 6-8 second fall duration
    - Smooth rotation and drift during fall
    - Maximum 7 active snowflakes
    - Continuous spawning at 0.5-1.5 second intervals
- **Enhanced Play Button**: Glowy snowy appearance with animated snowflakes and pulsing glow effect.
- **UI Auto-Hide System**: 
  - **Countdown Timer**: 5-second countdown after splash screen dismissal that automatically hides the UI for immersive viewing
  - **Manual Hide Toggle**: "Hide UI" button to manually hide/show the UI
  - **Double-Click to Wake**: Double-click anywhere on the canvas to restore the UI after auto-hide
  - **Interaction Disabling**: When UI is hidden, all buttons (Play, Settings, About) are disabled with no hover effects or click interactions
  - **Complete State Restoration**: UI restoration properly restores all elements including news reel, audio warning, and button positions
- **Settings Panel Enhancements**:
  - Tabbed interface with Audio, Controls, and Video tabs
  - Modern tab navigation with active state indicators
  - Smooth tab switching with fade animations
- **Audio Settings with Volume Sliders**:
  - Draggable volume sliders for Master Audio and Background Music
  - Real-time percentage display (0-100%)
  - Instant responsive dragging (no lag)
  - Toggle switches for enable/disable
  - Volume calculation: Master × Music = final volume
  - localStorage persistence for volume settings
  - Visual feedback with glow effects and smooth animations
  - Disabled state styling when toggles are off

### Changed
- News reel styling updated to pill shape with RGB LED border animation.
- Play button made clickable with enhanced visual feedback.
- Settings button now has glowy snowy appearance matching Play button.
- RGB animations slowed down for smoother visual effect (outer: 3s→6s, border: 12s→20s, inner: 10s→16s).
- News reel snowflakes system converted from CSS to JavaScript for dynamic random spawning.
- UI state management refactored for unified hide/show system used by both manual toggle and auto-hide.
- **World Generation Panel Simplified**: 
  - Removed progress bar and generate button simulation
  - Simplified to show world size (64x64) and toggle switches
  - Generate World button now triggers actual world regeneration and first-person mode
  - Button provides real-time feedback during generation ("Generating...", "Entering World...")
  - Button disabled during generation to prevent multiple clicks
- **Improved World Generation Flow**:
  - Async/await pattern for smooth non-blocking generation
  - requestAnimationFrame used for progressive generation steps
  - Separate game world container prevents menu world interference
  - Larger game world (2x size) for more immersive gameplay
  - Smooth transitions between generation and first-person mode entry
  - Full-screen loading screen displays during world generation with real-time progress
  - Progress callback system: `regenerateWorld(options, progressCallback)` accepts optional callback
  - Progress updates at key stages: terrain (0-30%), structures (30-60%), trees (60-90%), completion (90-100%)
  - World generation panel hides immediately when generation starts
  - ALL UI elements automatically hidden during loading (title, menu, buttons, news reel)
  - Loading screen blocks entire viewport with fully opaque background
  - Error handling with proper loading screen cleanup and UI restoration
- **Settings Panel**:
  - Transformed from simple panel to modern tabbed interface
  - Audio controls upgraded from simple toggles to draggable volume sliders
  - Improved visual hierarchy and organization
- **Camera System**: 
  - Dual camera mode support (orbit for menu, first-person for game)
  - Orbit controls disabled when entering first-person mode
  - Auto-rotate disabled during first-person gameplay

### Fixed
- **Volume Slider Jump Bug**: Fixed issue where grabbing the volume slider handle would cause the white circle (handle) to jump to position 0. The slider now updates position immediately on mousedown instead of waiting for the first mousemove event, preventing incorrect position calculations.
- **UI Interaction Bug**: Fixed issue where menu buttons (Play, Settings, About) remained clickable and showed hover effects when UI was hidden. Buttons now properly disabled with `pointer-events: none` and CSS `ui-hidden` class.
- **News Reel Missing**: Fixed bug where news reel would disappear after double-clicking to wake UI. News reel now properly restored with display, opacity, and pointer-events.
- **Audio Warning Position**: Fixed issue where audio warning box would move incorrectly after UI restoration. Audio warning now maintains proper positioning during hide/show cycles.

## [0.0.1 ALPHA] - 2025-01-27
### Added
- Modular project structure (`js/`, `css/`, `DOCS/`).
- `config.js` for centralized settings.
- `snow_system.md` for snow configuration documentation.

### Changed
- Refactored `ai_studio_code.html` into `index.html` + modules.
- Extracted CSS to `css/style.css`.

### Improved
- **Visuals**: Reduced intensity of snow reflections and bloom for a more natural look.
- **House**: Updated window design to be more realistic (individual windows instead of a strip).
